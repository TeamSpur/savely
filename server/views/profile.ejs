<% include head.ejs%>
<% function numberWithCommas(x) {
  x = x.toString();
  var pattern = /(-?\d+)(\d{3})/;
  while (pattern.test(x))
    x = x.replace(pattern, "$1,$2");
  return '$' + x;
}

var saveChanges = function(cell){
       $.ajax({
           type: 'POST',
           url: 'localhost:3000',
           dataType: "json",
           data: getData(cell),
           success: function (json){
               if(json.error){
                   console.log('Error : '+json.error);
               }else{
                   console.log('Data saved.');
               }
           },
           error: function(){
               console.log('Can not connect to the server.');
           }
       });
   }

var getData = function(cell){
    var data = {
        "id" : $.trim(cell.parent().data('id')), // Get row id
        "name" : $.trim(cell.data('name')), // Get the tuple name
        "value" : $.trim(cell.html()) // Get new value
    };
    return data;
}

var test = function(n) {
  return n * 2;
} %>


  <header><img id='logoSavely' src='/assets/logoGreen.png'></img></header>
    <div id='profilejs'>
    <div class="page-header text-center">
        <a href="/" class="btn btn-default btn-sm">Home Page</a>
        <a href="/logout" class="btn btn-default btn-sm">Logout</a>
    </div>
    <div class="row">
      <section class="profileContainer">
        <!-- ACCOUNT INFORMATION -->
        <div class="col-sm-6" id="personalContainer">
          <div class="well">
            <h3><span class="fa fa-user"></span> Account Information</h3>
            <% if (user.email) { %>
            <p>
              <strong>User Identification No.</strong>: <%= user.id %><br>
              <strong>Email</strong>: <%= user.email %>
            </p>
            <a href="/unlink/local" class="btn btn-default">Unlink</a>
            <% } else { %>
            <a href="/connect/local" class="btn btn-default">Connect Local</a>
            <% } %>
          </div>
        </div>
        <!-- INCOME INFORMATION -->
        <div class="col-sm-6" id="incomeContainer">
          <div class="well">
            <h3>Financial Information</h3>
            <table class="table">
              <tr>
                <th>Yearly Income</th>
              </tr>
              <tr data-id="1">
                <td contenteditable="true" data-name="A"><%= numberWithCommas(user.income) %></td>
              </tr>
            </table>
          </div>
        </div>
        <!-- BUDGET INFORMATION -->
        <div class="col-sm-6" id="budgetContainer">
          <div class="well">
            <h3>Budget Categories</h3>
            <div class="container">
              <div id="table" class="table-editable">
                <span class="table-add glyphicon glyphicon-plus"></span>
                <table class="table">
                  <tr>
                    <th>Category</th>
                    <th>Limit</th>
                    <th></th>
                  </tr>
                  <tr>
                    <td contenteditable="true">Rent</td>
                    <td contenteditable="true">$1000</td>
                    <td>
                      <span class="table-remove glyphicon glyphicon-remove"></span>
                    </td>
                  </tr>
                  <!-- This is our clonable table line -->
                  <tr class="hide">
                    <td contenteditable="true">Untitled</td>
                    <td contenteditable="true">0</td>
                    <td>
                      <span class="table-remove glyphicon glyphicon-remove"></span>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>
      </section>

<% include foot.ejs%>
